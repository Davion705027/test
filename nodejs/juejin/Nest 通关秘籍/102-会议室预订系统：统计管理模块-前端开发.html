<header>
        <style>
            .markdown-body{
                width: 80%;
                margin: auto;
            }
            .code-block-extension-header{
                display: none;
            }
        </style>
    </header><div class="markdown-body"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>上节写了统计用的两个接口，这节来加一下 swagger 文档，然后写下前端部分。</p>
<p>这个接口有 2 个 query 参数，返回值是一个对象，所以这样写：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5624c518ca6a4ab2abbe6aa2caa349f7~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1496&amp;h=1146&amp;s=279944&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">@<span class="hljs-title class_">ApiBearerAuth</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="2">@<span class="hljs-title class_">ApiQuery</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attr">name</span>: <span class="hljs-string">'startTime'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="5">    <span class="hljs-attr">description</span>: <span class="hljs-string">'开始时间'</span></span>
<span class="code-block-extension-codeLine" data-line-num="6">})</span>
<span class="code-block-extension-codeLine" data-line-num="7">@<span class="hljs-title class_">ApiQuery</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-attr">name</span>: <span class="hljs-string">'endTime'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">description</span>: <span class="hljs-string">'结束时间'</span></span>
<span class="code-block-extension-codeLine" data-line-num="11">})</span>
<span class="code-block-extension-codeLine" data-line-num="12">@<span class="hljs-title class_">ApiResponse</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="13">    <span class="hljs-attr">status</span>: <span class="hljs-title class_">HttpStatus</span>.<span class="hljs-property">OK</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="14">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">UserBookignCount</span></span>
<span class="code-block-extension-codeLine" data-line-num="15">})</span>
</code></pre>
<p>涉及到的 vo 在 src/statistic/vo/UserBookignCount.vo.ts</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ApiProperty</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@nestjs/swagger"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBookignCount</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-attr">userId</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">username</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="10"></span>
<span class="code-block-extension-codeLine" data-line-num="11">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="12">    <span class="hljs-attr">bookingCount</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>
<p>访问下 <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3005%2Fapi-doc" target="_blank" rel="nofollow noopener noreferrer" title="http://localhost:3005/api-doc" ref="nofollow noopener noreferrer">http://localhost:3005/api-doc</a></p>
<p>可以看到这个接口的文档：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc291426918c4c8c9fc36fa457e2a349~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1192&amp;h=1446&amp;s=141310&amp;e=png&amp;b=eef4fa" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>没啥问题。</p>
<p>然后添加另一个接口的：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df8f0a9c36eb492c99a5457c1b0e53ca~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1404&amp;h=704&amp;s=135804&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">@<span class="hljs-title class_">ApiBearerAuth</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="2">@<span class="hljs-title class_">ApiQuery</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attr">name</span>: <span class="hljs-string">'startTime'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="5">    <span class="hljs-attr">description</span>: <span class="hljs-string">'开始时间'</span></span>
<span class="code-block-extension-codeLine" data-line-num="6">})</span>
<span class="code-block-extension-codeLine" data-line-num="7">@<span class="hljs-title class_">ApiQuery</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-attr">name</span>: <span class="hljs-string">'endTime'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">description</span>: <span class="hljs-string">'结束时间'</span></span>
<span class="code-block-extension-codeLine" data-line-num="11">})</span>
<span class="code-block-extension-codeLine" data-line-num="12">@<span class="hljs-title class_">ApiResponse</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="13">    <span class="hljs-attr">status</span>: <span class="hljs-title class_">HttpStatus</span>.<span class="hljs-property">OK</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="14">    <span class="hljs-attr">type</span>: <span class="hljs-title class_">MeetingRoomUsedCount</span></span>
<span class="code-block-extension-codeLine" data-line-num="15">})</span>
</code></pre>
<p>src/statistic/MeetingRoomUsedCount.vo.ts</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ApiProperty</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@nestjs/swagger"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MeetingRoomUsedCount</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-attr">meetingRoomId</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">meetingRoomName</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="10"></span>
<span class="code-block-extension-codeLine" data-line-num="11">    @<span class="hljs-title class_">ApiProperty</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="12">    <span class="hljs-attr">usedCount</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
</code></pre>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee2de6a6bd654fd8a2b7f355d1f433aa~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1230&amp;h=1432&amp;s=143834&amp;e=png&amp;b=eef4fa" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后再加个 @ApiTags 把这俩接口文档分成一组：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/14cbe2e9d58a4f99a56279dffe060f3f~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1136&amp;h=928&amp;s=212482&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1ea48596bdec438d83099408c4647e8d~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=790&amp;h=344&amp;s=38018&amp;e=png&amp;b=f9f9f9" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这样，swagger 文档就完成了。</p>
<p>然后来写前端代码：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b4da8015f294391b3954d09bce2ee10~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1050&amp;h=672&amp;s=60291&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>统计的路由我们已经写过了，只要填内容就行。</p>
<p>原型图是这样的：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a0df7c49dbb84b33a6589816a68e619a~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3e83c09ddcd54e2a997f083784154baa~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>加个 antd 的 Form，然后再用 echarts 的图表展示下数据就好了。</p>
<p>先加下 form：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">DatePicker</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Select</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> <span class="hljs-string">"./statistics.css"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Statistics</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">getStatisticData</span>(<span class="hljs-params">values: { startTime: string; endTime: string; }</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="7">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(values);</span>
<span class="code-block-extension-codeLine" data-line-num="8">    }</span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statistics-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="11">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-form"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="12">            <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="13">                <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{getStatisticData}</span></span>
<span class="code-block-extension-codeLine" data-line-num="14">                <span class="hljs-attr">name</span>=<span class="hljs-string">"search"</span></span>
<span class="code-block-extension-codeLine" data-line-num="15">                <span class="hljs-attr">layout</span>=<span class="hljs-string">'inline'</span></span>
<span class="code-block-extension-codeLine" data-line-num="16">                <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="17">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="18">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"开始日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"startTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="19">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="20">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="21"></span>
<span class="code-block-extension-codeLine" data-line-num="22">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"结束日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"endTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="23">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="24">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="25"></span>
<span class="code-block-extension-codeLine" data-line-num="26">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"图表类型"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"chartType"</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{</span>"<span class="hljs-attr">bar</span>"}&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="27">                    <span class="hljs-tag">&lt;<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="28">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"pie"</span>&gt;</span>饼图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="29">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"bar"</span>&gt;</span>柱形图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="30">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="31">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="32"></span>
<span class="code-block-extension-codeLine" data-line-num="33">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="34">                    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="35">                        查询</span>
<span class="code-block-extension-codeLine" data-line-num="36">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="37">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="38">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="39">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="40">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-chart"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="41">            图表</span>
<span class="code-block-extension-codeLine" data-line-num="42">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="43">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="44">}</span>
</code></pre>
<p>css：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-selector-id">#statistics-container</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3">}</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-selector-id">#statistics-container</span> <span class="hljs-selector-class">.statistics-form</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="5">    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">40px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6">}</span>
<span class="code-block-extension-codeLine" data-line-num="7"><span class="hljs-selector-id">#statistics-container</span> <span class="hljs-selector-class">.statistics-chart</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-attribute">width</span>: <span class="hljs-number">800px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attribute">height</span>: <span class="hljs-number">600px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="10">}</span>
</code></pre>
<p>点击查询，会打印 form 的值：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c43ed1fdde14491784d46ba90330a6eb~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1670&amp;h=746&amp;s=163197&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后安装 echarts：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">npm install echarts <span class="hljs-attr">--save</span></span>
</code></pre>
<p>然后通过 useRef 拿到 dom 元素，再初始化下 echarts 的柱状图：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d21c7978d25046baa7923415b0b10a84~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1352&amp;h=1234&amp;s=216224&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f55153338166427cad63c4a81f518484~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1058&amp;h=386&amp;s=56361&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">DatePicker</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Select</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> <span class="hljs-string">"./statistics.css"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">import</span> { useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Statistics</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-keyword">const</span> containerRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">getStatisticData</span>(<span class="hljs-params">values: { startTime: string; endTime: string; }</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="11">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(values);</span>
<span class="code-block-extension-codeLine" data-line-num="12">    }</span>
<span class="code-block-extension-codeLine" data-line-num="13"></span>
<span class="code-block-extension-codeLine" data-line-num="14"></span>
<span class="code-block-extension-codeLine" data-line-num="15">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="16">        <span class="hljs-keyword">const</span> myChart = echarts.<span class="hljs-title function_">init</span>(containerRef.<span class="hljs-property">current</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="17">        myChart.<span class="hljs-title function_">setOption</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="18">            <span class="hljs-attr">title</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="19">                <span class="hljs-attr">text</span>: <span class="hljs-string">'ECharts 入门示例'</span></span>
<span class="code-block-extension-codeLine" data-line-num="20">            },</span>
<span class="code-block-extension-codeLine" data-line-num="21">            <span class="hljs-attr">tooltip</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="22">            <span class="hljs-attr">xAxis</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="23">                <span class="hljs-attr">data</span>: [<span class="hljs-string">'衬衫'</span>, <span class="hljs-string">'羊毛衫'</span>, <span class="hljs-string">'雪纺衫'</span>, <span class="hljs-string">'裤子'</span>, <span class="hljs-string">'高跟鞋'</span>, <span class="hljs-string">'袜子'</span>]</span>
<span class="code-block-extension-codeLine" data-line-num="24">            },</span>
<span class="code-block-extension-codeLine" data-line-num="25">            <span class="hljs-attr">yAxis</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="26">            <span class="hljs-attr">series</span>: [</span>
<span class="code-block-extension-codeLine" data-line-num="27">                {</span>
<span class="code-block-extension-codeLine" data-line-num="28">                    <span class="hljs-attr">name</span>: <span class="hljs-string">'销量'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="29">                    <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="30">                    <span class="hljs-attr">data</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">20</span>, <span class="hljs-number">36</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>]</span>
<span class="code-block-extension-codeLine" data-line-num="31">                }</span>
<span class="code-block-extension-codeLine" data-line-num="32">            ]</span>
<span class="code-block-extension-codeLine" data-line-num="33">        });</span>
<span class="code-block-extension-codeLine" data-line-num="34">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="35"></span>
<span class="code-block-extension-codeLine" data-line-num="36">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statistics-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="37">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-form"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="38">            <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="39">                <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{getStatisticData}</span></span>
<span class="code-block-extension-codeLine" data-line-num="40">                <span class="hljs-attr">name</span>=<span class="hljs-string">"search"</span></span>
<span class="code-block-extension-codeLine" data-line-num="41">                <span class="hljs-attr">layout</span>=<span class="hljs-string">'inline'</span></span>
<span class="code-block-extension-codeLine" data-line-num="42">                <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="43">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="44">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"开始日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"startTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="45">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="46">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="47"></span>
<span class="code-block-extension-codeLine" data-line-num="48">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"结束日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"endTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="49">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="50">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="51"></span>
<span class="code-block-extension-codeLine" data-line-num="52">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"图表类型"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"chartType"</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{</span>"<span class="hljs-attr">bar</span>"}&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="53">                    <span class="hljs-tag">&lt;<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="54">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"pie"</span>&gt;</span>饼图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="55">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"bar"</span>&gt;</span>柱形图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="56">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="57">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="58"></span>
<span class="code-block-extension-codeLine" data-line-num="59">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="60">                    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="61">                        查询</span>
<span class="code-block-extension-codeLine" data-line-num="62">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="63">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="64">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="65">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="66">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-chart"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="67">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="68">}</span>
</code></pre>
<p>这样 echarts 就成功引入了：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/283d9d2235a94a5e925053b53dc1a572~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1876&amp;h=1428&amp;s=141212&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后我们加一下接口：</p>
<p>在 src/interface/interfaces.ts 里加一下：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">meetingRoomUsedCount</span>(<span class="hljs-params">startTime: string, endTime: string</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/statistic/meetingRoomUsedCount'</span>, {</span>
<span class="code-block-extension-codeLine" data-line-num="3">        <span class="hljs-attr">params</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">            startTime,</span>
<span class="code-block-extension-codeLine" data-line-num="5">            endTime</span>
<span class="code-block-extension-codeLine" data-line-num="6">        }</span>
<span class="code-block-extension-codeLine" data-line-num="7">    });</span>
<span class="code-block-extension-codeLine" data-line-num="8">}</span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">userBookingCount</span>(<span class="hljs-params">startTime: string, endTime: string</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/statistic/userBookingCount'</span>, {</span>
<span class="code-block-extension-codeLine" data-line-num="12">        <span class="hljs-attr">params</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="13">            startTime,</span>
<span class="code-block-extension-codeLine" data-line-num="14">            endTime</span>
<span class="code-block-extension-codeLine" data-line-num="15">        }</span>
<span class="code-block-extension-codeLine" data-line-num="16">    });</span>
<span class="code-block-extension-codeLine" data-line-num="17">}</span>
</code></pre>
<p>我们加一个 state 来存储返回的数据，然后点击查询的时候请求接口：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ca37c9b8cc0b4030bccb8cea6c8f53f7~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1366&amp;h=1216&amp;s=297927&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>当数据变化的时候，渲染图表：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c393f117d93430aadb585638d2877c7~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=998&amp;h=1140&amp;s=134857&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">DatePicker</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Select</span>, message } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> <span class="hljs-string">"./statistics.css"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">import</span> { useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">import</span> { userBookingCount } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../interfaces/interfaces"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">"dayjs"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">interface <span class="hljs-title class_">UserBookingData</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">userId</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">username</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attr">bookingCount</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="12">}</span>
<span class="code-block-extension-codeLine" data-line-num="13"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Statistics</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="14"></span>
<span class="code-block-extension-codeLine" data-line-num="15">    <span class="hljs-keyword">const</span> [userBookingData, setUserBookingData] = useState&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">UserBookingData</span>&gt;&gt;();</span>
<span class="code-block-extension-codeLine" data-line-num="16"></span>
<span class="code-block-extension-codeLine" data-line-num="17">    <span class="hljs-keyword">const</span> containerRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="18"></span>
<span class="code-block-extension-codeLine" data-line-num="19">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getStatisticData</span>(<span class="hljs-params">values: { startTime: string; endTime: string; }</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="20"></span>
<span class="code-block-extension-codeLine" data-line-num="21">        <span class="hljs-keyword">const</span> startTime = <span class="hljs-title function_">dayjs</span>(values.<span class="hljs-property">startTime</span>).<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="22">        <span class="hljs-keyword">const</span> endTime = <span class="hljs-title function_">dayjs</span>(values.<span class="hljs-property">endTime</span>).<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="23"></span>
<span class="code-block-extension-codeLine" data-line-num="24">        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">userBookingCount</span>(startTime, endTime);</span>
<span class="code-block-extension-codeLine" data-line-num="25">        </span>
<span class="code-block-extension-codeLine" data-line-num="26">        <span class="hljs-keyword">const</span> { data } = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="27">        <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="28">            <span class="hljs-title function_">setUserBookingData</span>(data);</span>
<span class="code-block-extension-codeLine" data-line-num="29">        } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="30">            message.<span class="hljs-title function_">error</span>(data || <span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="31">        }</span>
<span class="code-block-extension-codeLine" data-line-num="32">    }</span>
<span class="code-block-extension-codeLine" data-line-num="33"></span>
<span class="code-block-extension-codeLine" data-line-num="34">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="35">        <span class="hljs-keyword">const</span> myChart = echarts.<span class="hljs-title function_">init</span>(containerRef.<span class="hljs-property">current</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="36"></span>
<span class="code-block-extension-codeLine" data-line-num="37">        <span class="hljs-keyword">if</span>(!userBookingData) {</span>
<span class="code-block-extension-codeLine" data-line-num="38">            <span class="hljs-keyword">return</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="39">        }</span>
<span class="code-block-extension-codeLine" data-line-num="40">    </span>
<span class="code-block-extension-codeLine" data-line-num="41">        myChart.<span class="hljs-title function_">setOption</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="42">            <span class="hljs-attr">title</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="43">                <span class="hljs-attr">text</span>: <span class="hljs-string">'用户预定情况'</span></span>
<span class="code-block-extension-codeLine" data-line-num="44">            },</span>
<span class="code-block-extension-codeLine" data-line-num="45">            <span class="hljs-attr">tooltip</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="46">            <span class="hljs-attr">xAxis</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="47">                <span class="hljs-attr">data</span>: userBookingData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">username</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="48">            },</span>
<span class="code-block-extension-codeLine" data-line-num="49">            <span class="hljs-attr">yAxis</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="50">            <span class="hljs-attr">series</span>: [</span>
<span class="code-block-extension-codeLine" data-line-num="51">                {</span>
<span class="code-block-extension-codeLine" data-line-num="52">                    <span class="hljs-attr">name</span>: <span class="hljs-string">'预定次数'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="53">                    <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="54">                    <span class="hljs-attr">data</span>: userBookingData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="55">                        <span class="hljs-keyword">return</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="56">                            <span class="hljs-attr">name</span>: item.<span class="hljs-property">username</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="57">                            <span class="hljs-attr">value</span>: item.<span class="hljs-property">bookingCount</span></span>
<span class="code-block-extension-codeLine" data-line-num="58">                        }</span>
<span class="code-block-extension-codeLine" data-line-num="59">                    })</span>
<span class="code-block-extension-codeLine" data-line-num="60">                }</span>
<span class="code-block-extension-codeLine" data-line-num="61">            ]</span>
<span class="code-block-extension-codeLine" data-line-num="62">        });</span>
<span class="code-block-extension-codeLine" data-line-num="63">    }, [userBookingData]);</span>
<span class="code-block-extension-codeLine" data-line-num="64"></span>
<span class="code-block-extension-codeLine" data-line-num="65">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statistics-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="66">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-form"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="67">            <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="68">                <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{getStatisticData}</span></span>
<span class="code-block-extension-codeLine" data-line-num="69">                <span class="hljs-attr">name</span>=<span class="hljs-string">"search"</span></span>
<span class="code-block-extension-codeLine" data-line-num="70">                <span class="hljs-attr">layout</span>=<span class="hljs-string">'inline'</span></span>
<span class="code-block-extension-codeLine" data-line-num="71">                <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="72">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="73">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"开始日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"startTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="74">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="75">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="76"></span>
<span class="code-block-extension-codeLine" data-line-num="77">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"结束日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"endTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="78">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="79">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="80"></span>
<span class="code-block-extension-codeLine" data-line-num="81">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"图表类型"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"chartType"</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{</span>"<span class="hljs-attr">bar</span>"}&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="82">                    <span class="hljs-tag">&lt;<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="83">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"pie"</span>&gt;</span>饼图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="84">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"bar"</span>&gt;</span>柱形图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="85">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="86">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="87"></span>
<span class="code-block-extension-codeLine" data-line-num="88">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="89">                    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="90">                        查询</span>
<span class="code-block-extension-codeLine" data-line-num="91">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="92">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="93">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="94">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="95">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-chart"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="96">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="97">}</span>
</code></pre>
<p>这样，点击查询的时候就会根据返回的数据渲染柱形图：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7b118a65729a4d8485ad331c93015f21~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1890&amp;h=1464&amp;s=139440&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后我们再加上饼图的部分：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa5d56c3366d44c6ade673537d80cf02~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=742&amp;h=416&amp;s=57784&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/29d3c56e45464a88a11d5ef6149fda49~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1038&amp;h=1114&amp;s=141511&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这样，统计的图表就完成了：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a162af31ba9846b98043d89106ef1d9a~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=2102&amp;h=1458&amp;s=598705&amp;e=gif&amp;f=44&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>我们在下面再加一个会议室使用情况的图表。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a907dbf321584b8485ab8e88c876b9f5~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1048&amp;h=192&amp;s=42998&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/acbd23471ffa4adfa20c94b39f594d18~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1504&amp;h=1312&amp;s=355658&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/10566b4ab89b4053ad344fc4e7c53c9e~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1150&amp;h=1106&amp;s=151394&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>过程一摸一样。</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">DatePicker</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Select</span>, message } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> <span class="hljs-string">"./statistics.css"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> echarts <span class="hljs-keyword">from</span> <span class="hljs-string">'echarts'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">import</span> { useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">import</span> { meetingRoomUsedCount, userBookingCount } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../interfaces/interfaces"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">"dayjs"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="7"><span class="hljs-keyword">import</span> { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd/es/form/Form"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="8"></span>
<span class="code-block-extension-codeLine" data-line-num="9">interface <span class="hljs-title class_">UserBookingData</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">userId</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attr">username</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="12">    <span class="hljs-attr">bookingCount</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="13">}</span>
<span class="code-block-extension-codeLine" data-line-num="14">interface <span class="hljs-title class_">MeetingRoomUsedData</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="15">    <span class="hljs-attr">meetingRoomName</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="16">    <span class="hljs-attr">meetingRoomId</span>: number;</span>
<span class="code-block-extension-codeLine" data-line-num="17">    <span class="hljs-attr">usedCount</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="18">}</span>
<span class="code-block-extension-codeLine" data-line-num="19"></span>
<span class="code-block-extension-codeLine" data-line-num="20"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Statistics</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="21"></span>
<span class="code-block-extension-codeLine" data-line-num="22">    <span class="hljs-keyword">const</span> [userBookingData, setUserBookingData] = useState&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">UserBookingData</span>&gt;&gt;();</span>
<span class="code-block-extension-codeLine" data-line-num="23">    <span class="hljs-keyword">const</span> [meetingRoomUsedData, setMeetingRoomUsedData] = useState&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">MeetingRoomUsedData</span>&gt;&gt;();</span>
<span class="code-block-extension-codeLine" data-line-num="24"></span>
<span class="code-block-extension-codeLine" data-line-num="25">    <span class="hljs-keyword">const</span> containerRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="26">    <span class="hljs-keyword">const</span> containerRef2 = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="27"></span>
<span class="code-block-extension-codeLine" data-line-num="28">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getStatisticData</span>(<span class="hljs-params">values: { startTime: string; endTime: string; }</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="29"></span>
<span class="code-block-extension-codeLine" data-line-num="30">        <span class="hljs-keyword">const</span> startTime = <span class="hljs-title function_">dayjs</span>(values.<span class="hljs-property">startTime</span>).<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="31">        <span class="hljs-keyword">const</span> endTime = <span class="hljs-title function_">dayjs</span>(values.<span class="hljs-property">endTime</span>).<span class="hljs-title function_">format</span>(<span class="hljs-string">'YYYY-MM-DD'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="32"></span>
<span class="code-block-extension-codeLine" data-line-num="33">        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">userBookingCount</span>(startTime, endTime);</span>
<span class="code-block-extension-codeLine" data-line-num="34">        </span>
<span class="code-block-extension-codeLine" data-line-num="35">        <span class="hljs-keyword">const</span> { data } = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="36">        <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="37">            <span class="hljs-title function_">setUserBookingData</span>(data);</span>
<span class="code-block-extension-codeLine" data-line-num="38">        } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="39">            message.<span class="hljs-title function_">error</span>(data || <span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="40">        }</span>
<span class="code-block-extension-codeLine" data-line-num="41"></span>
<span class="code-block-extension-codeLine" data-line-num="42">        <span class="hljs-keyword">const</span> res2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">meetingRoomUsedCount</span>(startTime, endTime);</span>
<span class="code-block-extension-codeLine" data-line-num="43">        </span>
<span class="code-block-extension-codeLine" data-line-num="44">        <span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: data2 } = res2.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="45">        <span class="hljs-keyword">if</span>(res2.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res2.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="46">            <span class="hljs-title function_">setMeetingRoomUsedData</span>(data2);</span>
<span class="code-block-extension-codeLine" data-line-num="47">        } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="48">            message.<span class="hljs-title function_">error</span>(data2 || <span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="49">        }</span>
<span class="code-block-extension-codeLine" data-line-num="50">    }</span>
<span class="code-block-extension-codeLine" data-line-num="51"></span>
<span class="code-block-extension-codeLine" data-line-num="52">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="53">        <span class="hljs-keyword">const</span> myChart = echarts.<span class="hljs-title function_">init</span>(containerRef.<span class="hljs-property">current</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="54"></span>
<span class="code-block-extension-codeLine" data-line-num="55">        <span class="hljs-keyword">if</span>(!userBookingData) {</span>
<span class="code-block-extension-codeLine" data-line-num="56">            <span class="hljs-keyword">return</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="57">        }</span>
<span class="code-block-extension-codeLine" data-line-num="58">    </span>
<span class="code-block-extension-codeLine" data-line-num="59">        myChart.<span class="hljs-title function_">setOption</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="60">            <span class="hljs-attr">title</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="61">                <span class="hljs-attr">text</span>: <span class="hljs-string">'用户预定情况'</span></span>
<span class="code-block-extension-codeLine" data-line-num="62">            },</span>
<span class="code-block-extension-codeLine" data-line-num="63">            <span class="hljs-attr">tooltip</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="64">            <span class="hljs-attr">xAxis</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="65">                <span class="hljs-attr">data</span>: userBookingData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">username</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="66">            },</span>
<span class="code-block-extension-codeLine" data-line-num="67">            <span class="hljs-attr">yAxis</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="68">            <span class="hljs-attr">series</span>: [</span>
<span class="code-block-extension-codeLine" data-line-num="69">                {</span>
<span class="code-block-extension-codeLine" data-line-num="70">                    <span class="hljs-attr">name</span>: <span class="hljs-string">'预定次数'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="71">                    <span class="hljs-attr">type</span>: form.<span class="hljs-title function_">getFieldValue</span>(<span class="hljs-string">'chartType'</span>),</span>
<span class="code-block-extension-codeLine" data-line-num="72">                    <span class="hljs-attr">data</span>: userBookingData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="73">                        <span class="hljs-keyword">return</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="74">                            <span class="hljs-attr">name</span>: item.<span class="hljs-property">username</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="75">                            <span class="hljs-attr">value</span>: item.<span class="hljs-property">bookingCount</span></span>
<span class="code-block-extension-codeLine" data-line-num="76">                        }</span>
<span class="code-block-extension-codeLine" data-line-num="77">                    })</span>
<span class="code-block-extension-codeLine" data-line-num="78">                }</span>
<span class="code-block-extension-codeLine" data-line-num="79">            ]</span>
<span class="code-block-extension-codeLine" data-line-num="80">        });</span>
<span class="code-block-extension-codeLine" data-line-num="81">    }, [userBookingData]);</span>
<span class="code-block-extension-codeLine" data-line-num="82"></span>
<span class="code-block-extension-codeLine" data-line-num="83">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="84">        <span class="hljs-keyword">const</span> myChart = echarts.<span class="hljs-title function_">init</span>(containerRef2.<span class="hljs-property">current</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="85"></span>
<span class="code-block-extension-codeLine" data-line-num="86">        <span class="hljs-keyword">if</span>(!meetingRoomUsedData) {</span>
<span class="code-block-extension-codeLine" data-line-num="87">            <span class="hljs-keyword">return</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="88">        }</span>
<span class="code-block-extension-codeLine" data-line-num="89">    </span>
<span class="code-block-extension-codeLine" data-line-num="90">        myChart.<span class="hljs-title function_">setOption</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="91">            <span class="hljs-attr">title</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="92">                <span class="hljs-attr">text</span>: <span class="hljs-string">'会议室使用情况'</span></span>
<span class="code-block-extension-codeLine" data-line-num="93">            },</span>
<span class="code-block-extension-codeLine" data-line-num="94">            <span class="hljs-attr">tooltip</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="95">            <span class="hljs-attr">xAxis</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="96">                <span class="hljs-attr">data</span>: meetingRoomUsedData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">meetingRoomName</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="97">            },</span>
<span class="code-block-extension-codeLine" data-line-num="98">            <span class="hljs-attr">yAxis</span>: {},</span>
<span class="code-block-extension-codeLine" data-line-num="99">            <span class="hljs-attr">series</span>: [</span>
<span class="code-block-extension-codeLine" data-line-num="100">                {</span>
<span class="code-block-extension-codeLine" data-line-num="101">                    <span class="hljs-attr">name</span>: <span class="hljs-string">'使用次数'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="102">                    <span class="hljs-attr">type</span>: form.<span class="hljs-title function_">getFieldValue</span>(<span class="hljs-string">'chartType'</span>),</span>
<span class="code-block-extension-codeLine" data-line-num="103">                    <span class="hljs-attr">data</span>: meetingRoomUsedData?.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="104">                        <span class="hljs-keyword">return</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="105">                            <span class="hljs-attr">name</span>: item.<span class="hljs-property">meetingRoomName</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="106">                            <span class="hljs-attr">value</span>: item.<span class="hljs-property">usedCount</span></span>
<span class="code-block-extension-codeLine" data-line-num="107">                        }</span>
<span class="code-block-extension-codeLine" data-line-num="108">                    })</span>
<span class="code-block-extension-codeLine" data-line-num="109">                }</span>
<span class="code-block-extension-codeLine" data-line-num="110">            ]</span>
<span class="code-block-extension-codeLine" data-line-num="111">        });</span>
<span class="code-block-extension-codeLine" data-line-num="112">    }, [meetingRoomUsedData]);</span>
<span class="code-block-extension-codeLine" data-line-num="113"></span>
<span class="code-block-extension-codeLine" data-line-num="114">    <span class="hljs-keyword">const</span> [form] = <span class="hljs-title function_">useForm</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="115"></span>
<span class="code-block-extension-codeLine" data-line-num="116">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statistics-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="117">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-form"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="118">            <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="119">                <span class="hljs-attr">form</span>=<span class="hljs-string">{form}</span></span>
<span class="code-block-extension-codeLine" data-line-num="120">                <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{getStatisticData}</span></span>
<span class="code-block-extension-codeLine" data-line-num="121">                <span class="hljs-attr">name</span>=<span class="hljs-string">"search"</span></span>
<span class="code-block-extension-codeLine" data-line-num="122">                <span class="hljs-attr">layout</span>=<span class="hljs-string">'inline'</span></span>
<span class="code-block-extension-codeLine" data-line-num="123">                <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="124">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="125">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"开始日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"startTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="126">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="127">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="128"></span>
<span class="code-block-extension-codeLine" data-line-num="129">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"结束日期"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"endTime"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="130">                    <span class="hljs-tag">&lt;<span class="hljs-name">DatePicker</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="131">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="132"></span>
<span class="code-block-extension-codeLine" data-line-num="133">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"图表类型"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"chartType"</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{</span>"<span class="hljs-attr">bar</span>"}&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="134">                    <span class="hljs-tag">&lt;<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="135">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"pie"</span>&gt;</span>饼图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="136">                        <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"bar"</span>&gt;</span>柱形图<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="137">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Select</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="138">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="139"></span>
<span class="code-block-extension-codeLine" data-line-num="140">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="141">                    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="142">                        查询</span>
<span class="code-block-extension-codeLine" data-line-num="143">                    <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="144">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="145">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="146">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="147">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-chart"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="148">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics-chart"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef2}</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="149">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="150">}</span>
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e58b11e720e04887b90311a4df5a4912~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1970&amp;h=1438&amp;s=1854764&amp;e=gif&amp;f=38&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>代码在<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQuarkGluonPlasma%2Fnestjs-course-code%2Ftree%2Fmain%2Fmeeting_room_booking_system_backend" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/meeting_room_booking_system_backend" ref="nofollow noopener noreferrer">小册仓库</a>。</p>
<h2 data-id="heading-0">总结</h2>
<p>这节我们加了 swagger 文档并且写了统计管理模块的前端代码。</p>
<p>前端部分主要是 echarts 的图表，这个根据返回的数据调整下格式，然后设置到 echarts 的 options 就行。</p>
<p>至此，所有模块的钱后端代码就都完成了。</p></div>