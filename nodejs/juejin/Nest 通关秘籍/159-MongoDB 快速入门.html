<header>
        <style>
            .markdown-body{
                width: 80%;
                margin: auto;
            }
            .code-block-extension-header{
                display: none;
            }
        </style>
    </header><div class="markdown-body"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>数据库我们学习了 mysql，这节来再来学下 mongodb。</p>
<p>在 docker desktop 搜索 mongo 镜像，然后把它跑起来：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7964844898c24521b3c42cc1906b78bb~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1820&amp;h=1356&amp;s=224586&amp;e=png&amp;b=f3f4f8" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>指定容器名、映射的端口号，以及挂载到 /data/db 的本地目录：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e609de4add42458db6d479c4bc8bac0d~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1556&amp;h=1422&amp;s=225825&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这个本地目录是本地的任何一个目录都行，用来存放 mongodb 的数据的。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d98f8dab560d4566b8d3a2b6f13c34e5~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=2384&amp;h=1354&amp;s=508585&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>跑起来之后，进入 terminal，开始学习 mongodb 的 crud：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/457143fdd8f14c53a7c0514931b1e15c~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1882&amp;h=1282&amp;s=238877&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>输入 mongosh，就可以敲 mongo 命令了：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">ini</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-ini code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">show dbs<span class="hljs-comment">;</span></span>
<span class="code-block-extension-codeLine" data-line-num="2">show databases<span class="hljs-comment">;</span></span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9cee65144f1c4fc982413c7aa5ca117e~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1118&amp;h=726&amp;s=128228&amp;e=png&amp;b=f3f3f5" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>查看下现有的 database。</p>
<p>和 mysql 一样，mongodb 也是通过一个个 database 来存储不同数据的，只不过 mysql 的 database 里存的是 table，而 mongo 里存的是 Collection。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4f36495507f4d8588aef91186382eb4~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=900&amp;h=596&amp;s=174686&amp;e=png&amp;b=fbfbfb" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>创建或者切换 database 用 use</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">ini</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-ini code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">use hello-mongo<span class="hljs-comment">;</span></span>
</code></pre>
<p>然后 db 命令查看当前 database：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">ini</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-ini code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db<span class="hljs-comment">;</span></span>
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6532b74ca3974a8c8a54191d211ddd5d~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=570&amp;h=448&amp;s=47060&amp;e=png&amp;b=f6f6f8" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>但这时候你再用 show dbs 会发现没有这个 db：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d36f3ad079264d73acd6582ba72a585c~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=594&amp;h=454&amp;s=50865&amp;e=png&amp;b=f5f5f7" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这是因为默认有了一个 collection 之后才会把 database 写入硬盘。</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-title function_">createCollection</span>(<span class="hljs-string">'aaa'</span>);</span>
</code></pre>
<p>创建了一个 collection 之后，再次 show dbs，这时候就看到这个新的 database 了：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/354ad786c39c44d3b7201d4cdf1b62cb~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=880&amp;h=860&amp;s=115140&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>如果你想删除 database，用这个命令：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-title function_">dropDatabase</span>();</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/101b32af98c849009a735b1fb2f2fa96~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=598&amp;h=444&amp;s=53271&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>创建和删除 database 我们会了，然后是 collection：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9bad84da104845499e5c415656da7d30~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=766&amp;h=584&amp;s=68031&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>用 db.createCollection 创建 db，然后可以用 db.xxx.drop() 删掉。</p>
<p>接下来向 collection 中插入几个 document：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'13222222222'</span>});</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">insertMany</span>([{ <span class="hljs-attr">name</span>: <span class="hljs-string">'dong'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">21</span>}, {<span class="hljs-attr">name</span>: <span class="hljs-string">'xxx'</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">'writing'</span>]}]);</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">insertMany</span>([{ <span class="hljs-attr">name</span>: <span class="hljs-string">'dong2'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>}, {<span class="hljs-attr">name</span>: <span class="hljs-string">'guang2'</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">'writing'</span>]}]);</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ee9691d90a64dacbcaef6cbed0a6957~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1610&amp;h=1062&amp;s=192695&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>可以看到，插入的数据可以是任意结构的，这就是 mongodb 和 mysql 的最大区别。</p>
<p>不像 mysql 只能在 table 里存结构化的记录一样，mongodb 的 collection 里可以存任意结构的 document。</p>
<p>再就是 mysql 是需要用 sql 来 crud 的，而 mongodb 里是用 api。</p>
<p>但完成的功能是一样的，可以在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.mongodb.com%2Fdocs%2Fmongodb-shell%2Fcrud%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://www.mongodb.com/docs/mongodb-shell/crud/" ref="nofollow noopener noreferrer">mongodb 文档</a>里看到每个 api 的介绍下面都有对应的 sql 写法：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2672a61daeb4722ab464546afd2cd71~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1252&amp;h=766&amp;s=103301&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b92f4741b184e1aa0aea7c9ef04aa81~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1478&amp;h=922&amp;s=137115&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>我们试下查询：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({<span class="hljs-attr">age</span>: <span class="hljs-number">20</span>});</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>});</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/390c09c85ee7438ea9abbcc677a825c0~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1228&amp;h=906&amp;s=125311&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>find 是查询多条记录，而 findOne 只返回第一条。</p>
<p>当不传过滤条件的时候，就是返回所有的 Document：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>()</span>
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6352fb6251e4cc5940a10bae71b7c35~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1132&amp;h=1022&amp;s=141139&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>查询条件有多个值的时候这样写，类似 sql 的 in：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">age</span>: { <span class="hljs-attr">$in</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>]}})</span>
</code></pre>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b469f218690c4b888368bfb051be7258~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1124&amp;h=684&amp;s=103581&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>in 是包含， nin 是不包含。</p>
<p>类似 in 的还有 gt（great than）、lt（less than）、gte（great than equal ）、lte（less than equal ）、ne（not equal）</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f85ea35fd7c441b8d2bcb9cfdd4c6be~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1146&amp;h=836&amp;s=129614&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>多个条件的时候用 and：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">$and</span>: [{<span class="hljs-attr">age</span>: { <span class="hljs-attr">$gte</span>: <span class="hljs-number">20</span> }}, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/dong\d/</span>}]})</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">$and</span>: [{<span class="hljs-attr">age</span>: { <span class="hljs-attr">$gte</span>: <span class="hljs-number">20</span> }}, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/dong*/</span>}]})</span>
</code></pre>
<p>搜索 age 大于等于 20，并且名字包含 dong 的 Document，这里用的正则做的模糊匹配：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5ed6e2c0a4e6495a96a0d57f36eec928~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1184&amp;h=664&amp;s=115367&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>用 or 的话就是两个条件满足一个就行：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">$or</span>: [{<span class="hljs-attr">age</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">20</span> }}, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/dong*/</span>}]})</span>
</code></pre>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/084a9a83213f4b2fa7732cf014859645~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1134&amp;h=500&amp;s=83910&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>分页用的是 skip 和 limit 方法：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">skip</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">limit</span>(<span class="hljs-number">2</span>)</span>
</code></pre>
<p>从第一条 Document 开始，取 2 条：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/302aee71ae304de39ba34fc790f2c44b~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1266&amp;h=1306&amp;s=191213&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>更新的话用 updateOne、updateMany 方法：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>}, { <span class="hljs-attr">$set</span>: {<span class="hljs-attr">age</span>: <span class="hljs-number">30</span>} })</span>
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe549e27503f4899b6d06b8dbae93c97~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1054&amp;h=910&amp;s=115283&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>如果在更新的时候带上时间戳，可以用 $currentDate：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>}, { <span class="hljs-attr">$set</span>: {<span class="hljs-attr">age</span>: <span class="hljs-number">30</span>}, <span class="hljs-attr">$currentDate</span>: { <span class="hljs-attr">aaa</span>: <span class="hljs-literal">true</span> } })</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5870c77d4f4c44feb3dbd664fd77c026~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1502&amp;h=966&amp;s=140361&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>如果你想替换整个的 document，那么用 replaceOne：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">replaceOne</span>({<span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>}, { <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>})</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0193eb8482a94689924dbc4c233d5f64~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1236&amp;h=1182&amp;s=174389&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>删除的话，也有 deleteOne 和 deleteMany 两个方法：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">deleteMany</span>({ <span class="hljs-attr">age</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">20</span> }});</span>
</code></pre>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8776470d8797476eab34b80c8888094e~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1244&amp;h=1388&amp;s=216094&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>此外，还有 count 可以计数：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">count</span>()</span>
<span class="code-block-extension-codeLine" data-line-num="2"></span>
<span class="code-block-extension-codeLine" data-line-num="3">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">count</span>({ <span class="hljs-attr">name</span>: <span class="hljs-regexp">/guang/</span>})</span>
</code></pre>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4431218ae4274d4f8aba5b77153963c5~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1168&amp;h=958&amp;s=125800&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>sort 可以排序，1 是升序、-1 是降序：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">sort</span>({ <span class="hljs-attr">age</span>: -<span class="hljs-number">1</span>})</span>
</code></pre>
<p>按照 age 降序：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abed6c924da1466fac75586e42446b40~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1326&amp;h=1262&amp;s=180491&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">sort</span>({ <span class="hljs-attr">age</span>: -<span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>})</span>
</code></pre>
<p>先按照 age 降序，再按照 name 升序：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a5dff59167b4e47991ef2c9fabf06b6~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1142&amp;h=542&amp;s=75845&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这样，CRUD 我们都过了一遍。</p>
<p>当然，这些操作也都可以在 GUI 里可视化的搞，这样就不用敲命令了：</p>
<p>下载官方 GUI 工具 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.mongodb.com%2Fproducts%2Ftools%2Fcompass" target="_blank" rel="nofollow noopener noreferrer" title="https://www.mongodb.com/products/tools/compass" ref="nofollow noopener noreferrer">Mongo Compass</a>：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d72020b680940b7b1651fd05ecb2afc~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=2522&amp;h=1446&amp;s=291571&amp;e=png&amp;b=081e2a" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>连接上 mongodb 的 server：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d0521b85612541c980928b9a53f3e810~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=2254&amp;h=1054&amp;s=218737&amp;e=png&amp;b=fefdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>在 GUI 工具里操作就很方便直观了：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d1de2e794294139a0acf6fac4f44978~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1774&amp;h=1220&amp;s=203782&amp;e=png&amp;b=fffefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>可以看到所有的 database、collection、document。</p>
<p>在这里输入过滤条件后点击 find：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/496b6b16db1849bfa8e76c200df424ca~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=2178&amp;h=666&amp;s=108995&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>更新和删除也都很直观：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bef3f4f8eb1645f899c1fd2a7588ca64~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1694&amp;h=376&amp;s=69510&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d24886202e224f73afdef3090c71e517~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1630&amp;h=274&amp;s=51400&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e375eaf369a4368ab186a8ae7e5abe9~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1664&amp;h=218&amp;s=37631&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<h2 data-id="heading-0">总结</h2>
<p>这节我们入门了 mongodb。</p>
<p>它的 database 下是 collection，collection 包含多个 document。</p>
<p>document 可以是任意结构的，这点和 mysql 的 table 不同。</p>
<p>mongo 是通过 api 来做 CRUD 的，不是用的 sql。</p>
<p>我们过了一遍常用的命令和 api：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">show dbs; <span class="hljs-comment">// 显示 database</span></span>
<span class="code-block-extension-codeLine" data-line-num="2">show databases;</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">use hello-mongo; <span class="hljs-comment">// 切换或者创建 database</span></span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6">db; <span class="hljs-comment">// 查看当前 database</span></span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">db.<span class="hljs-title function_">dropDatabase</span>(); <span class="hljs-comment">// 删除 database</span></span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10">db.<span class="hljs-title function_">createCollection</span>(<span class="hljs-string">'aaa'</span>); <span class="hljs-comment">// 创建 collection</span></span>
<span class="code-block-extension-codeLine" data-line-num="11"></span>
<span class="code-block-extension-codeLine" data-line-num="12">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">drop</span>() <span class="hljs-comment">//删除 collection</span></span>
<span class="code-block-extension-codeLine" data-line-num="13"></span>
<span class="code-block-extension-codeLine" data-line-num="14">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'13222222222'</span>});<span class="hljs-comment">// 插入 document</span></span>
<span class="code-block-extension-codeLine" data-line-num="15"></span>
<span class="code-block-extension-codeLine" data-line-num="16">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">insertMany</span>([{ <span class="hljs-attr">name</span>: <span class="hljs-string">'dong'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">21</span>}, {<span class="hljs-attr">name</span>: <span class="hljs-string">'xxx'</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">'writing'</span>]}]);</span>
<span class="code-block-extension-codeLine" data-line-num="17"></span>
<span class="code-block-extension-codeLine" data-line-num="18">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({<span class="hljs-attr">age</span>: <span class="hljs-number">20</span>}); <span class="hljs-comment">// 查询 collection</span></span>
<span class="code-block-extension-codeLine" data-line-num="19"></span>
<span class="code-block-extension-codeLine" data-line-num="20">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>});</span>
<span class="code-block-extension-codeLine" data-line-num="21"></span>
<span class="code-block-extension-codeLine" data-line-num="22">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">findOne</span>(); <span class="hljs-comment">// 查询所有 collection</span></span>
<span class="code-block-extension-codeLine" data-line-num="23"></span>
<span class="code-block-extension-codeLine" data-line-num="24">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">age</span>: { <span class="hljs-attr">$in</span>: [<span class="hljs-number">20</span>, <span class="hljs-number">21</span>]}}) <span class="hljs-comment">// 使用 in、nin 查询多个值</span></span>
<span class="code-block-extension-codeLine" data-line-num="25"></span>
<span class="code-block-extension-codeLine" data-line-num="26">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">$and</span>: [{<span class="hljs-attr">age</span>: { <span class="hljs-attr">$gte</span>: <span class="hljs-number">20</span> }}, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/dong\d/</span>}]}) <span class="hljs-comment">// 使用 and 指定多个条件同时成立</span></span>
<span class="code-block-extension-codeLine" data-line-num="27"></span>
<span class="code-block-extension-codeLine" data-line-num="28">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">$or</span>: [{<span class="hljs-attr">age</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">20</span> }}, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/dong*/</span>}]}) <span class="hljs-comment">// 使用 or 表示或者</span></span>
<span class="code-block-extension-codeLine" data-line-num="29"></span>
<span class="code-block-extension-codeLine" data-line-num="30">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">skip</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">limit</span>(<span class="hljs-number">2</span>) <span class="hljs-comment">// 使用 skip + limit 实现分页</span></span>
<span class="code-block-extension-codeLine" data-line-num="31"></span>
<span class="code-block-extension-codeLine" data-line-num="32">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>}, { <span class="hljs-attr">$set</span>: {<span class="hljs-attr">age</span>: <span class="hljs-number">30</span>}, <span class="hljs-attr">$currentDate</span>: { <span class="hljs-attr">aaa</span>: <span class="hljs-literal">true</span> } }) <span class="hljs-comment">// updateOne、updateMany 更新</span></span>
<span class="code-block-extension-codeLine" data-line-num="33"></span>
<span class="code-block-extension-codeLine" data-line-num="34">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">replaceOne</span>({<span class="hljs-attr">name</span>: <span class="hljs-string">'guang'</span>}, { <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>}) <span class="hljs-comment">// 整体替换</span></span>
<span class="code-block-extension-codeLine" data-line-num="35"></span>
<span class="code-block-extension-codeLine" data-line-num="36">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">deleteMany</span>({ <span class="hljs-attr">age</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">20</span> }}); <span class="hljs-comment">// deleteOne、deleteMany 删除</span></span>
<span class="code-block-extension-codeLine" data-line-num="37"></span>
<span class="code-block-extension-codeLine" data-line-num="38">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">count</span>({ <span class="hljs-attr">name</span>: <span class="hljs-regexp">/guang/</span>})</span>
<span class="code-block-extension-codeLine" data-line-num="39"></span>
<span class="code-block-extension-codeLine" data-line-num="40">db.<span class="hljs-property">xxx</span>.<span class="hljs-title function_">find</span>().<span class="hljs-title function_">sort</span>({ <span class="hljs-attr">age</span>: -<span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>})</span>
</code></pre>
<p>当然，平时不用敲 api，用 Mongo Compass 的 GUI 工具操作非常简单。</p></div>