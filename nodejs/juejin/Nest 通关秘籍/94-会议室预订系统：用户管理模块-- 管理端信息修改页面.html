<header>
        <style>
            .markdown-body{
                width: 80%;
                margin: auto;
            }
            .code-block-extension-header{
                display: none;
            }
        </style>
    </header><div class="markdown-body"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre>code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote>p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre>code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这节，我们来写管理端的这两个页面：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ce7922e5d4e24a2ea5457075866b19e4~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1224&amp;h=852&amp;s=54200&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f037c80960cf4a20b04283fc4c454578~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1474&amp;h=1006&amp;s=64942&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>很明显，它们是和这几个管理页面平级的，点击用户图标的时候打开：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15459f904c474be0bad3403a96f70a48~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1388&amp;h=732&amp;s=74362&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>所以，我们在它平级添加个路由：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd2506a3eb7242efbeb48f99547d6b92~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=912&amp;h=1174&amp;s=149599&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">{</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attr">path</span>: <span class="hljs-string">"/user"</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModifyMenu</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ModifyMenu</span>&gt;</span></span>,</span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-attr">children</span>: [</span>
<span class="code-block-extension-codeLine" data-line-num="5">      {</span>
<span class="code-block-extension-codeLine" data-line-num="6">        <span class="hljs-attr">path</span>: <span class="hljs-string">'info_modify'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="7">        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">InfoModify</span>/&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="8">      },</span>
<span class="code-block-extension-codeLine" data-line-num="9">      {</span>
<span class="code-block-extension-codeLine" data-line-num="10">        <span class="hljs-attr">path</span>: <span class="hljs-string">'password_modify'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="11">        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PasswordModify</span>/&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="12">      },</span>
<span class="code-block-extension-codeLine" data-line-num="13">    ]</span>
<span class="code-block-extension-codeLine" data-line-num="14">},</span>
</code></pre>
<p>然后创建这几个对应的组件：</p>
<p>src/pages/ModifyMenu/ModifyMenu.stx</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Outlet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Menu</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">AntdMenu</span>, <span class="hljs-title class_">MenuProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> <span class="hljs-string">'./menu.css'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">const</span> <span class="hljs-attr">items</span>: <span class="hljs-title class_">MenuProps</span>[<span class="hljs-string">'items'</span>] = [</span>
<span class="code-block-extension-codeLine" data-line-num="6">    {</span>
<span class="code-block-extension-codeLine" data-line-num="7">        <span class="hljs-attr">key</span>: <span class="hljs-string">'1'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="8">        <span class="hljs-attr">label</span>: <span class="hljs-string">"信息修改"</span></span>
<span class="code-block-extension-codeLine" data-line-num="9">    },</span>
<span class="code-block-extension-codeLine" data-line-num="10">    {</span>
<span class="code-block-extension-codeLine" data-line-num="11">        <span class="hljs-attr">key</span>: <span class="hljs-string">'2'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="12">        <span class="hljs-attr">label</span>: <span class="hljs-string">"密码修改"</span></span>
<span class="code-block-extension-codeLine" data-line-num="13">    }</span>
<span class="code-block-extension-codeLine" data-line-num="14">];</span>
<span class="code-block-extension-codeLine" data-line-num="15"></span>
<span class="code-block-extension-codeLine" data-line-num="16"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ModifyMenu</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="17">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"menu-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="18">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"menu-area"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="19">            <span class="hljs-tag">&lt;<span class="hljs-name">AntdMenu</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="20">                <span class="hljs-attr">defaultSelectedKeys</span>=<span class="hljs-string">{[</span>'<span class="hljs-attr">1</span>']}</span>
<span class="code-block-extension-codeLine" data-line-num="21">                <span class="hljs-attr">items</span>=<span class="hljs-string">{items}</span></span>
<span class="code-block-extension-codeLine" data-line-num="22">            /&gt;</span>
<span class="code-block-extension-codeLine" data-line-num="23">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="24">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"content-area"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="25">            <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Outlet</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="26">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="27">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="28">}</span>
</code></pre>
<p>用到的 menu.css：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-selector-id">#menu-container</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attribute">display</span>: flex;</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attribute">flex-direction</span>: row;</span>
<span class="code-block-extension-codeLine" data-line-num="4">}</span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-selector-id">#menu-container</span> <span class="hljs-selector-class">.menu-area</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
</code></pre>
<p>然后是</p>
<p>src/pages/InfoModify/InfoModify.tsx</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">InfoModify</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>InfoModify<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="3">}</span>
</code></pre>
<p>src/pages/PasswordModify/PasswordModify.tsx</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PasswordModify</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>PasswordModify<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="3">}</span>
</code></pre>
<p>在 index.tsx 引入，然后跑一下：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a7db8f6e4bb42fe9ce1cc80a2717030~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=932&amp;h=484&amp;s=50494&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ecc82e80a42f4ee38f1da6fe343df5ea~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=886&amp;h=434&amp;s=51776&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>没啥问题。</p>
<p>但是现在点击菜单是没反应的，我们给它加上 click 事件。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89b884cc9b6046d7a704f7126f00e9bc~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1166&amp;h=920&amp;s=168602&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">const</span> <span class="hljs-attr">handleMenuItemClick</span>: <span class="hljs-title class_">MenuClickEventHandler</span> = <span class="hljs-function">(<span class="hljs-params">info</span>) =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">if</span>(info.<span class="hljs-property">key</span> === <span class="hljs-string">'1'</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="3">        router.<span class="hljs-title function_">navigate</span>(<span class="hljs-string">'/user/info_modify'</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="4">    } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="5">        router.<span class="hljs-title function_">navigate</span>(<span class="hljs-string">'/user/password_modify'</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="6">    }</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
</code></pre>
<p>这里用到的 router 要在 index.tsx 里导出：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9ded1b38cb8469b9143e8813f25fe61~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=912&amp;h=408&amp;s=76242&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>测试下：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fec33aa11a6744bb9d79d20fcec4143a~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1054&amp;h=546&amp;s=202089&amp;e=gif&amp;f=22&amp;b=fcfcfc" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>点击菜单可以切换路由了。</p>
<p>但现在有个问题，页面一刷新，选中的菜单项就变了：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e09f174def714d518a05059d7e04fde9~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=882&amp;h=424&amp;s=194471&amp;e=gif&amp;f=46&amp;b=fbfbfb" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>我们需要根据当前路由来决定选中哪个：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e009f117f5e7487fa65ba8b12031cd04~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1584&amp;h=654&amp;s=137817&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这里用到了 react-router 的 useLocation 的 hook 来拿到当前地址：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1">location.<span class="hljs-property">pathname</span> === <span class="hljs-string">'/user/info_modify'</span> ? [<span class="hljs-string">'1'</span>] : [<span class="hljs-string">'2'</span>]</span>
</code></pre>
<p>这样，刷新之后选中的菜单项也是对的：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa8eef339a8042608b13f3a193907dcb~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=952&amp;h=450&amp;s=136464&amp;e=gif&amp;f=31&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>改下 Index 组件，添加两个链接：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/469a065b6e34465eb09ff68739091b87~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=916&amp;h=720&amp;s=139314&amp;e=png&amp;b=202020" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">html</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-html code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"header"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sys_name"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="3">        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>会议室预定系统-后台管理<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="5">    <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/user/info_modify"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="6">        <span class="hljs-tag">&lt;<span class="hljs-name">UserOutlined</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"icon"</span>/&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="8"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
</code></pre>
<p>并且添加它的样式：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-selector-id">#index-container</span> <span class="hljs-selector-class">.sys_name</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attribute">text-decoration</span>: none;</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attribute">color</span>: <span class="hljs-number">#000</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4">}</span>
</code></pre>
<p>这样就可以方便跳转对应的路由了：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/430f8f5b14164a4fa809285c57313d22~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1750&amp;h=826&amp;s=178938&amp;e=gif&amp;f=32&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后，我们来实现信息修改页面：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ce7922e5d4e24a2ea5457075866b19e4~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1224&amp;h=852&amp;s=54200&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>之前用户端修改信息页面也是类似的，我们直接拿过来就行：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Input</span>, message } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd/es/form/Form'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> { useCallback, useEffect, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">import</span> <span class="hljs-string">'./info_modify.css'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">import</span> { useNavigate } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">HeadPicUpload</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./HeadPicUpload'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8"><span class="hljs-keyword">export</span> interface <span class="hljs-title class_">UserInfo</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">username</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">headPic</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attr">nickName</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="12">    <span class="hljs-attr">email</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="13">    <span class="hljs-attr">captcha</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="14">}</span>
<span class="code-block-extension-codeLine" data-line-num="15"></span>
<span class="code-block-extension-codeLine" data-line-num="16"><span class="hljs-keyword">const</span> layout1 = {</span>
<span class="code-block-extension-codeLine" data-line-num="17">    <span class="hljs-attr">labelCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">6</span> },</span>
<span class="code-block-extension-codeLine" data-line-num="18">    <span class="hljs-attr">wrapperCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">18</span> }</span>
<span class="code-block-extension-codeLine" data-line-num="19">}</span>
<span class="code-block-extension-codeLine" data-line-num="20"></span>
<span class="code-block-extension-codeLine" data-line-num="21"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">InfoModify</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="22">    <span class="hljs-keyword">const</span> [form] = <span class="hljs-title function_">useForm</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="23">    <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="24"></span>
<span class="code-block-extension-codeLine" data-line-num="25">    <span class="hljs-keyword">const</span> onFinish = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">values</span>: <span class="hljs-title class_">UserInfo</span>) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="26"></span>
<span class="code-block-extension-codeLine" data-line-num="27">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="28"></span>
<span class="code-block-extension-codeLine" data-line-num="29">    <span class="hljs-keyword">const</span> sendCaptcha = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="30">        </span>
<span class="code-block-extension-codeLine" data-line-num="31">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="32"></span>
<span class="code-block-extension-codeLine" data-line-num="33">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="34">        <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">query</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="35">            </span>
<span class="code-block-extension-codeLine" data-line-num="36">        }</span>
<span class="code-block-extension-codeLine" data-line-num="37">        <span class="hljs-title function_">query</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="38">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="39"></span>
<span class="code-block-extension-codeLine" data-line-num="40">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"updateInfo-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="41">        <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="42">            <span class="hljs-attr">form</span>=<span class="hljs-string">{form}</span></span>
<span class="code-block-extension-codeLine" data-line-num="43">            {<span class="hljs-attr">...layout1</span>}</span>
<span class="code-block-extension-codeLine" data-line-num="44">            <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{onFinish}</span></span>
<span class="code-block-extension-codeLine" data-line-num="45">            <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="46">            <span class="hljs-attr">autoComplete</span>=<span class="hljs-string">"off"</span></span>
<span class="code-block-extension-codeLine" data-line-num="47">        &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="48">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="49">                <span class="hljs-attr">label</span>=<span class="hljs-string">"头像"</span></span>
<span class="code-block-extension-codeLine" data-line-num="50">                <span class="hljs-attr">name</span>=<span class="hljs-string">"headPic"</span></span>
<span class="code-block-extension-codeLine" data-line-num="51">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[</span></span>
<span class="code-block-extension-codeLine" data-line-num="52">                    { <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入头像!' },</span>
<span class="code-block-extension-codeLine" data-line-num="53">                ]}</span>
<span class="code-block-extension-codeLine" data-line-num="54">                <span class="hljs-attr">shouldUpdate</span></span>
<span class="code-block-extension-codeLine" data-line-num="55">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="56">                <span class="hljs-tag">&lt;<span class="hljs-name">HeadPicUpload</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">HeadPicUpload</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="57">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="58"></span>
<span class="code-block-extension-codeLine" data-line-num="59">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="60">                <span class="hljs-attr">label</span>=<span class="hljs-string">"昵称"</span></span>
<span class="code-block-extension-codeLine" data-line-num="61">                <span class="hljs-attr">name</span>=<span class="hljs-string">"nickName"</span></span>
<span class="code-block-extension-codeLine" data-line-num="62">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[</span></span>
<span class="code-block-extension-codeLine" data-line-num="63">                    { <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入昵称!' },</span>
<span class="code-block-extension-codeLine" data-line-num="64">                ]}</span>
<span class="code-block-extension-codeLine" data-line-num="65">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="66">                <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="67">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="68"></span>
<span class="code-block-extension-codeLine" data-line-num="69">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="70">                <span class="hljs-attr">label</span>=<span class="hljs-string">"邮箱"</span></span>
<span class="code-block-extension-codeLine" data-line-num="71">                <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span></span>
<span class="code-block-extension-codeLine" data-line-num="72">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[</span></span>
<span class="code-block-extension-codeLine" data-line-num="73">                    { <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入邮箱!' },</span>
<span class="code-block-extension-codeLine" data-line-num="74">                    { <span class="hljs-attr">type:</span> "<span class="hljs-attr">email</span>", <span class="hljs-attr">message:</span> '请输入合法邮箱地址!'}</span>
<span class="code-block-extension-codeLine" data-line-num="75">                ]}</span>
<span class="code-block-extension-codeLine" data-line-num="76">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="77">                <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">disabled</span>/&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="78">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="79"></span>
<span class="code-block-extension-codeLine" data-line-num="80">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'captcha-wrapper'</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="81">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="82">                    <span class="hljs-attr">label</span>=<span class="hljs-string">"验证码"</span></span>
<span class="code-block-extension-codeLine" data-line-num="83">                    <span class="hljs-attr">name</span>=<span class="hljs-string">"captcha"</span></span>
<span class="code-block-extension-codeLine" data-line-num="84">                    <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入验证码!' }]}</span>
<span class="code-block-extension-codeLine" data-line-num="85">                &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="86">                    <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="87">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="88">                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{sendCaptcha}</span>&gt;</span>发送验证码<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="89">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="90"></span>
<span class="code-block-extension-codeLine" data-line-num="91">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="92">                {<span class="hljs-attr">...layout1</span>}</span>
<span class="code-block-extension-codeLine" data-line-num="93">                <span class="hljs-attr">label</span>=<span class="hljs-string">" "</span></span>
<span class="code-block-extension-codeLine" data-line-num="94">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="95">                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'btn'</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="96">                    修改</span>
<span class="code-block-extension-codeLine" data-line-num="97">                <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="98">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="99">        <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="100">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>   </span>
<span class="code-block-extension-codeLine" data-line-num="101">}</span>
</code></pre>
<p>css 部分如下：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-selector-id">#updateInfo-container</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span> auto <span class="hljs-number">0</span> auto;</span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-attribute">text-align</span>: center;</span>
<span class="code-block-extension-codeLine" data-line-num="5">}</span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-selector-id">#updateInfo-container</span> <span class="hljs-selector-class">.btn</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="8">}</span>
<span class="code-block-extension-codeLine" data-line-num="9"><span class="hljs-selector-id">#updateInfo-container</span> <span class="hljs-selector-class">.captcha-wrapper</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attribute">display</span>: flex;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attribute">justify-content</span>: flex-end;</span>
<span class="code-block-extension-codeLine" data-line-num="12">}</span>
</code></pre>
<p>用到的 HeadPicUpload 组件如下：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">InboxOutlined</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ant-design/icons"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> { message } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Dragger</span>, { <span class="hljs-title class_">DraggerProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd/es/upload/Dragger"</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">interface <span class="hljs-title class_">HeadPicUploadProps</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="6">    value?: string;</span>
<span class="code-block-extension-codeLine" data-line-num="7">    onChange?: <span class="hljs-title class_">Function</span></span>
<span class="code-block-extension-codeLine" data-line-num="8">}</span>
<span class="code-block-extension-codeLine" data-line-num="9"></span>
<span class="code-block-extension-codeLine" data-line-num="10"><span class="hljs-keyword">let</span> <span class="hljs-attr">onChange</span>: <span class="hljs-title class_">Function</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="11"></span>
<span class="code-block-extension-codeLine" data-line-num="12"><span class="hljs-keyword">const</span> <span class="hljs-attr">props</span>: <span class="hljs-title class_">DraggerProps</span> = {</span>
<span class="code-block-extension-codeLine" data-line-num="13">    <span class="hljs-attr">name</span>: <span class="hljs-string">'file'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="14">    <span class="hljs-attr">action</span>: <span class="hljs-string">'http://localhost:3005/user/upload'</span>,</span>
<span class="code-block-extension-codeLine" data-line-num="15">    <span class="hljs-title function_">onChange</span>(<span class="hljs-params">info</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="16">        <span class="hljs-keyword">const</span> { status } = info.<span class="hljs-property">file</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="17">        <span class="hljs-keyword">if</span> (status === <span class="hljs-string">'done'</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="18">            <span class="hljs-title function_">onChange</span>(info.<span class="hljs-property">file</span>.<span class="hljs-property">response</span>.<span class="hljs-property">data</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="19">            message.<span class="hljs-title function_">success</span>(<span class="hljs-string">`<span class="hljs-subst">${info.file.name}</span> 文件上传成功`</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="20">        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status === <span class="hljs-string">'error'</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="21">            message.<span class="hljs-title function_">error</span>(<span class="hljs-string">`<span class="hljs-subst">${info.file.name}</span> 文件上传失败`</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="22">        }</span>
<span class="code-block-extension-codeLine" data-line-num="23">    }</span>
<span class="code-block-extension-codeLine" data-line-num="24">};</span>
<span class="code-block-extension-codeLine" data-line-num="25"></span>
<span class="code-block-extension-codeLine" data-line-num="26"><span class="hljs-keyword">const</span> dragger = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Dragger</span> {<span class="hljs-attr">...props</span>}&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="27">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ant-upload-drag-icon"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="28">        <span class="hljs-tag">&lt;<span class="hljs-name">InboxOutlined</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="29">    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="30">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ant-upload-text"</span>&gt;</span>点击或拖拽文件到这个区域来上传<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="31"><span class="hljs-tag">&lt;/<span class="hljs-name">Dragger</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="32"></span>
<span class="code-block-extension-codeLine" data-line-num="33"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HeadPicUpload</span>(<span class="hljs-params">props: HeadPicUploadProps</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="34"></span>
<span class="code-block-extension-codeLine" data-line-num="35">    onChange = props.<span class="hljs-property">onChange</span>!</span>
<span class="code-block-extension-codeLine" data-line-num="36"></span>
<span class="code-block-extension-codeLine" data-line-num="37">    <span class="hljs-keyword">return</span> props?.<span class="hljs-property">value</span> ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="38">        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{</span>'<span class="hljs-attr">http:</span>//<span class="hljs-attr">localhost:3005</span>/' + <span class="hljs-attr">props.value</span>} <span class="hljs-attr">alt</span>=<span class="hljs-string">"头像"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"100"</span>/&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="39">        {dragger}</span>
<span class="code-block-extension-codeLine" data-line-num="40">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="41">        {dragger}</span>
<span class="code-block-extension-codeLine" data-line-num="42">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="43">}</span>
</code></pre>
<p>这些都是我们前面写过一遍的。</p>
<p>渲染出来是这样的：
<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cc66ffc5c02b4f25ba19dfcb3781fdb1~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1390&amp;h=1062&amp;s=105257&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>上传功能也是可用的：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13ea12f22f364ce8bb2e4048a5b45386~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1508&amp;h=1102&amp;s=2554441&amp;e=gif&amp;f=44&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后我们还要加上回显接口、发送验证码接口、更新接口。</p>
<p>在 interfaces.tsx 加上这三个接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/user/info'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="3">}</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateInfo</span>(<span class="hljs-params">data: UserInfo</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/user/admin/update'</span>, data);</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
<span class="code-block-extension-codeLine" data-line-num="8"></span>
<span class="code-block-extension-codeLine" data-line-num="9"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateUserInfoCaptcha</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/user/update/captcha'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="11">}</span>
</code></pre>
<p>然后先调用下回显接口：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a80c3ba613348729abaac5cb91caa74~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1088&amp;h=650&amp;s=118529&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">query</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-keyword">const</span> { data } = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="7"></span>
<span class="code-block-extension-codeLine" data-line-num="8">        form.<span class="hljs-title function_">setFieldValue</span>(<span class="hljs-string">'headPic'</span>, data.<span class="hljs-property">headPic</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="9">        form.<span class="hljs-title function_">setFieldValue</span>(<span class="hljs-string">'nickName'</span>, data.<span class="hljs-property">nickName</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="10">        form.<span class="hljs-title function_">setFieldValue</span>(<span class="hljs-string">'email'</span>, data.<span class="hljs-property">email</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="11">    }</span>
<span class="code-block-extension-codeLine" data-line-num="12">}</span>
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d99f772765944ffb6996f9ecf570082~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1296&amp;h=1038&amp;s=105185&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>可以看到，正确回显了数据。</p>
<p>然后是发送验证码接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">const</span> sendCaptcha = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">updateUserInfoCaptcha</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="4">        message.<span class="hljs-title function_">success</span>(res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="5">    } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="6">        message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="7">    }</span>
<span class="code-block-extension-codeLine" data-line-num="8">}, []);</span>
</code></pre>
<p>不过现在的邮箱地址不是真实的，我们手动去数据库里改一下：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be0d70d50be54ec684302156fbd29e25~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1278&amp;h=690&amp;s=291331&amp;e=png&amp;b=f7f7f7" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>改完点击 apply。</p>
<p>然后需要重新登录一遍，因为现在后端会直接从 jwt 里取邮箱地址，重新登录才会更新。</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d168bfc253124caeba8d900348eb8813~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1610&amp;h=1042&amp;s=123252&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>邮箱收到了验证码：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4617abb6cff64ca7baa9d7a461e8cfc0~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=550&amp;h=246&amp;s=29191&amp;e=png&amp;b=f6f6f6" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后加上更新用户信息的接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">const</span> onFinish = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">values</span>: <span class="hljs-title class_">UserInfo</span>) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">updateInfo</span>(values);</span>
<span class="code-block-extension-codeLine" data-line-num="3"></span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="5">        <span class="hljs-keyword">const</span> { <span class="hljs-attr">message</span>: msg, data} = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6">        <span class="hljs-keyword">if</span>(msg === <span class="hljs-string">'success'</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="7">            message.<span class="hljs-title function_">success</span>(<span class="hljs-string">'用户信息更新成功'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="8">        } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="9">            message.<span class="hljs-title function_">error</span>(data);</span>
<span class="code-block-extension-codeLine" data-line-num="10">        }</span>
<span class="code-block-extension-codeLine" data-line-num="11">    } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="12">        message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="13">    }</span>
<span class="code-block-extension-codeLine" data-line-num="14">}, []);</span>
</code></pre>
<p>上传头像，点击发送验证码，填入收到的验证码，点击修改：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3126a2b302f4cbf992cd7923afb945b~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1658&amp;h=1224&amp;s=182721&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>修改成功后，刷新页面，可以看到依然是修改后的数据，就代表修改成功了：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f230d255cfaf4c78be46a32c38d16e23~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1458&amp;h=1306&amp;s=250001&amp;e=gif&amp;f=21&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>接下来是密码修改页面：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f037c80960cf4a20b04283fc4c454578~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1474&amp;h=1006&amp;s=64942&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>代码如下：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Input</span>, message } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="2"><span class="hljs-keyword">import</span> { useForm } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd/es/form/Form'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3"><span class="hljs-keyword">import</span> <span class="hljs-string">'./password_modify.css'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="4"><span class="hljs-keyword">import</span> { useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="5"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Link</span>, useNavigate } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6"></span>
<span class="code-block-extension-codeLine" data-line-num="7"><span class="hljs-keyword">export</span> interface <span class="hljs-title class_">UpdatePassword</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-attr">email</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="9">    <span class="hljs-attr">captcha</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attr">password</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attr">confirmPassword</span>: string;</span>
<span class="code-block-extension-codeLine" data-line-num="12">}</span>
<span class="code-block-extension-codeLine" data-line-num="13"></span>
<span class="code-block-extension-codeLine" data-line-num="14"><span class="hljs-keyword">const</span> layout1 = {</span>
<span class="code-block-extension-codeLine" data-line-num="15">    <span class="hljs-attr">labelCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">6</span> },</span>
<span class="code-block-extension-codeLine" data-line-num="16">    <span class="hljs-attr">wrapperCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">18</span> }</span>
<span class="code-block-extension-codeLine" data-line-num="17">}</span>
<span class="code-block-extension-codeLine" data-line-num="18"></span>
<span class="code-block-extension-codeLine" data-line-num="19"><span class="hljs-keyword">const</span> layout2 = {</span>
<span class="code-block-extension-codeLine" data-line-num="20">    <span class="hljs-attr">labelCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">0</span> },</span>
<span class="code-block-extension-codeLine" data-line-num="21">    <span class="hljs-attr">wrapperCol</span>: { <span class="hljs-attr">span</span>: <span class="hljs-number">24</span> }</span>
<span class="code-block-extension-codeLine" data-line-num="22">}</span>
<span class="code-block-extension-codeLine" data-line-num="23"></span>
<span class="code-block-extension-codeLine" data-line-num="24"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PasswordModify</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="25">    <span class="hljs-keyword">const</span> [form] = <span class="hljs-title function_">useForm</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="26">    <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="27"></span>
<span class="code-block-extension-codeLine" data-line-num="28">    <span class="hljs-keyword">const</span> onFinish = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">values</span>: <span class="hljs-title class_">UpdatePassword</span>) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="29"></span>
<span class="code-block-extension-codeLine" data-line-num="30">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="31"></span>
<span class="code-block-extension-codeLine" data-line-num="32">    <span class="hljs-keyword">const</span> sendCaptcha = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="33"></span>
<span class="code-block-extension-codeLine" data-line-num="34">    }, []);</span>
<span class="code-block-extension-codeLine" data-line-num="35"></span>
<span class="code-block-extension-codeLine" data-line-num="36">    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"updatePassword-container"</span>&gt;</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="37">        <span class="hljs-tag">&lt;<span class="hljs-name">Form</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="38">            <span class="hljs-attr">form</span>=<span class="hljs-string">{form}</span></span>
<span class="code-block-extension-codeLine" data-line-num="39">            {<span class="hljs-attr">...layout1</span>}</span>
<span class="code-block-extension-codeLine" data-line-num="40">            <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{onFinish}</span></span>
<span class="code-block-extension-codeLine" data-line-num="41">            <span class="hljs-attr">colon</span>=<span class="hljs-string">{false}</span></span>
<span class="code-block-extension-codeLine" data-line-num="42">            <span class="hljs-attr">autoComplete</span>=<span class="hljs-string">"off"</span></span>
<span class="code-block-extension-codeLine" data-line-num="43">        &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="44">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="45">                <span class="hljs-attr">label</span>=<span class="hljs-string">"密码"</span></span>
<span class="code-block-extension-codeLine" data-line-num="46">                <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span></span>
<span class="code-block-extension-codeLine" data-line-num="47">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入密码!' }]}</span>
<span class="code-block-extension-codeLine" data-line-num="48">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="49">                <span class="hljs-tag">&lt;<span class="hljs-name">Input.Password</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="50">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="51"></span>
<span class="code-block-extension-codeLine" data-line-num="52">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="53">                <span class="hljs-attr">label</span>=<span class="hljs-string">"确认密码"</span></span>
<span class="code-block-extension-codeLine" data-line-num="54">                <span class="hljs-attr">name</span>=<span class="hljs-string">"confirmPassword"</span></span>
<span class="code-block-extension-codeLine" data-line-num="55">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入确认密码!' }]}</span>
<span class="code-block-extension-codeLine" data-line-num="56">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="57">                <span class="hljs-tag">&lt;<span class="hljs-name">Input.Password</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="58">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="59">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="60">                <span class="hljs-attr">label</span>=<span class="hljs-string">"邮箱"</span></span>
<span class="code-block-extension-codeLine" data-line-num="61">                <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span></span>
<span class="code-block-extension-codeLine" data-line-num="62">                <span class="hljs-attr">rules</span>=<span class="hljs-string">{[</span></span>
<span class="code-block-extension-codeLine" data-line-num="63">                    { <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入邮箱!' },</span>
<span class="code-block-extension-codeLine" data-line-num="64">                    { <span class="hljs-attr">type:</span> "<span class="hljs-attr">email</span>", <span class="hljs-attr">message:</span> '请输入合法邮箱地址!'}</span>
<span class="code-block-extension-codeLine" data-line-num="65">                ]}</span>
<span class="code-block-extension-codeLine" data-line-num="66">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="67">                <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="68">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="69"></span>
<span class="code-block-extension-codeLine" data-line-num="70">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'captcha-wrapper'</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="71">                <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="72">                    <span class="hljs-attr">label</span>=<span class="hljs-string">"验证码"</span></span>
<span class="code-block-extension-codeLine" data-line-num="73">                    <span class="hljs-attr">name</span>=<span class="hljs-string">"captcha"</span></span>
<span class="code-block-extension-codeLine" data-line-num="74">                    <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> '请输入验证码!' }]}</span>
<span class="code-block-extension-codeLine" data-line-num="75">                &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="76">                    <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> /&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="77">                <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="78">                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{sendCaptcha}</span>&gt;</span>发送验证码<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="79">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="80"></span>
<span class="code-block-extension-codeLine" data-line-num="81">            <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span></span></span>
<span class="code-block-extension-codeLine" data-line-num="82">                {<span class="hljs-attr">...layout1</span>}</span>
<span class="code-block-extension-codeLine" data-line-num="83">                <span class="hljs-attr">label</span>=<span class="hljs-string">" "</span></span>
<span class="code-block-extension-codeLine" data-line-num="84">            &gt;</span>
<span class="code-block-extension-codeLine" data-line-num="85">                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'btn'</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">htmlType</span>=<span class="hljs-string">"submit"</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="86">                    修改密码</span>
<span class="code-block-extension-codeLine" data-line-num="87">                <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="88">            <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="89">        <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="code-block-extension-codeLine" data-line-num="90">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>   </span>
<span class="code-block-extension-codeLine" data-line-num="91">}</span>
</code></pre>
<p>用到的 password_modify.css：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">css</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-css code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-selector-id">#updatePassword-container</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">40px</span> auto;</span>
<span class="code-block-extension-codeLine" data-line-num="4">    <span class="hljs-attribute">text-align</span>: center;</span>
<span class="code-block-extension-codeLine" data-line-num="5">}</span>
<span class="code-block-extension-codeLine" data-line-num="6"><span class="hljs-selector-id">#updatePassword-container</span> <span class="hljs-selector-class">.btn</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="8">}</span>
<span class="code-block-extension-codeLine" data-line-num="9"><span class="hljs-selector-id">#updatePassword-container</span> <span class="hljs-selector-class">.captcha-wrapper</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-attribute">display</span>: flex;</span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-attribute">justify-content</span>: flex-end;</span>
<span class="code-block-extension-codeLine" data-line-num="12">}</span>
</code></pre>
<p>渲染出来是这样的：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/155046bc2a764dd89853348757faa5c5~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1250&amp;h=844&amp;s=88595&amp;e=png&amp;b=ffffff" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后在 interfaces.ts 加上用到的发送验证码、修改密码这两个接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePasswordCaptcha</span>(<span class="hljs-params">email: string</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/user/update_password/captcha'</span>, {</span>
<span class="code-block-extension-codeLine" data-line-num="3">        <span class="hljs-attr">params</span>: {</span>
<span class="code-block-extension-codeLine" data-line-num="4">            <span class="hljs-attr">address</span>: email</span>
<span class="code-block-extension-codeLine" data-line-num="5">        }</span>
<span class="code-block-extension-codeLine" data-line-num="6">    });</span>
<span class="code-block-extension-codeLine" data-line-num="7">}</span>
<span class="code-block-extension-codeLine" data-line-num="8"></span>
<span class="code-block-extension-codeLine" data-line-num="9"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePassword</span>(<span class="hljs-params">data: UpdatePassword</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="10">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axiosInstance.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/user/admin/update_password'</span>, data);</span>
<span class="code-block-extension-codeLine" data-line-num="11">}</span>
</code></pre>
<p>然后先在页面调用下回显接口：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40e41b22a624401a95b04490b7a63ea5~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1168&amp;h=620&amp;s=120954&amp;e=png&amp;b=202020" alt="" loading="lazy" class="medium-zoom-image"></p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">query</span>(<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="3">        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="4"></span>
<span class="code-block-extension-codeLine" data-line-num="5">        <span class="hljs-keyword">const</span> { data } = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="6"></span>
<span class="code-block-extension-codeLine" data-line-num="7">        <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {  </span>
<span class="code-block-extension-codeLine" data-line-num="8">            form.<span class="hljs-title function_">setFieldValue</span>(<span class="hljs-string">'username'</span>, data.<span class="hljs-property">username</span>);              </span>
<span class="code-block-extension-codeLine" data-line-num="9">            form.<span class="hljs-title function_">setFieldValue</span>(<span class="hljs-string">'email'</span>, data.<span class="hljs-property">email</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="10">        }</span>
<span class="code-block-extension-codeLine" data-line-num="11">    }</span>
<span class="code-block-extension-codeLine" data-line-num="12">    <span class="hljs-title function_">query</span>();</span>
<span class="code-block-extension-codeLine" data-line-num="13">}, []);</span>
</code></pre>
<p>并把邮箱 Input 设置为 disabled</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e97e4f7b3d0640f58308fb5d22c5804c~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1178&amp;h=728&amp;s=139128&amp;e=png&amp;b=1f1f1f" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这样邮箱地址就会回显，并且只读：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a24c626f1aa240b0a8535128c7124e4d~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1228&amp;h=808&amp;s=89414&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>然后调用发送验证码接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">const</span> sendCaptcha = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">const</span> address = form.<span class="hljs-title function_">getFieldValue</span>(<span class="hljs-string">'email'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="3">    <span class="hljs-keyword">if</span>(!address) {</span>
<span class="code-block-extension-codeLine" data-line-num="4">        <span class="hljs-keyword">return</span> message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'邮箱地址为空'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="5">    }</span>
<span class="code-block-extension-codeLine" data-line-num="6"></span>
<span class="code-block-extension-codeLine" data-line-num="7">    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">updatePasswordCaptcha</span>(address);</span>
<span class="code-block-extension-codeLine" data-line-num="8">    <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="9">        message.<span class="hljs-title function_">success</span>(res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="10">    } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="11">        message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="12">    }</span>
<span class="code-block-extension-codeLine" data-line-num="13">}, []);</span>
</code></pre>
<p>点击发送验证码：</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aecd500776594a43bda17a6a642a02ab~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1902&amp;h=1042&amp;s=138378&amp;e=gif&amp;f=24&amp;b=fdfdfd" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>邮箱收到了对应的验证码：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/114b7251e9d04bfca1d1a7e235c92368~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=538&amp;h=284&amp;s=29654&amp;e=png&amp;b=f8f8f8" alt="" loading="lazy" class="medium-zoom-image">
然后加上修改密码接口：</p>
<pre><div class="code-block-extension-header" style="background-color: rgb(248, 248, 248);"><div class="code-block-extension-headerLeft"><div class="code-block-extension-foldBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.924 9.617A1 1 0 0 0 16 9H8a1 1 0 0 0-.707 1.707l4 4a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0 .217-1.09z" data-name="Down"></path></svg></div></div><div class="code-block-extension-headerRight"><span class="code-block-extension-lang">javascript</span><div class="code-block-extension-copyCodeBtn">复制代码</div></div></div><code class="hljs language-javascript code-block-extension-codeShowNum"><span class="code-block-extension-codeLine" data-line-num="1"><span class="hljs-keyword">const</span> onFinish = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">values</span>: <span class="hljs-title class_">UpdatePassword</span>) =&gt; {</span>
<span class="code-block-extension-codeLine" data-line-num="2">    <span class="hljs-keyword">if</span>(values.<span class="hljs-property">password</span> !== values.<span class="hljs-property">confirmPassword</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="3">        <span class="hljs-keyword">return</span> message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'两次密码不一致'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="4">    }</span>
<span class="code-block-extension-codeLine" data-line-num="5"></span>
<span class="code-block-extension-codeLine" data-line-num="6">    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">updatePassword</span>({</span>
<span class="code-block-extension-codeLine" data-line-num="7">        ...values,</span>
<span class="code-block-extension-codeLine" data-line-num="8">        <span class="hljs-attr">username</span>: form.<span class="hljs-title function_">getFieldValue</span>(<span class="hljs-string">'username'</span>)</span>
<span class="code-block-extension-codeLine" data-line-num="9">    });</span>
<span class="code-block-extension-codeLine" data-line-num="10"></span>
<span class="code-block-extension-codeLine" data-line-num="11">    <span class="hljs-keyword">const</span> { <span class="hljs-attr">message</span>: msg, data} = res.<span class="hljs-property">data</span>;</span>
<span class="code-block-extension-codeLine" data-line-num="12"></span>
<span class="code-block-extension-codeLine" data-line-num="13">    <span class="hljs-keyword">if</span>(res.<span class="hljs-property">status</span> === <span class="hljs-number">201</span> || res.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</span>
<span class="code-block-extension-codeLine" data-line-num="14">        message.<span class="hljs-title function_">success</span>(<span class="hljs-string">'密码修改成功'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="15">    } <span class="hljs-keyword">else</span> {</span>
<span class="code-block-extension-codeLine" data-line-num="16">        message.<span class="hljs-title function_">error</span>(data || <span class="hljs-string">'系统繁忙，请稍后再试'</span>);</span>
<span class="code-block-extension-codeLine" data-line-num="17">    }</span>
<span class="code-block-extension-codeLine" data-line-num="18">}, []);</span>
</code></pre>
<p>提示密码修改成功：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/54aaa08d41224c8492bf05d3ba3f6738~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1642&amp;h=848&amp;s=116278&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>我们可以去登录页面，用老密码试试：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a27cef8f52944f95b160d28cb9d11db8~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=996&amp;h=614&amp;s=51523&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>再用新密码试试：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a4449dc50da4036b7fa36678fe1df61~tplv-k3u1fbpfcp-jj-mark:1663:0:0:0:q75.awebp#?w=1094&amp;h=658&amp;s=54442&amp;e=png&amp;b=fefefe" alt="" loading="lazy" class="medium-zoom-image"></p>
<p>这样，管理端的用户相关的页面就完成了。</p>
<p>案例代码上传了<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQuarkGluonPlasma%2Fnestjs-course-code%2Ftree%2Fmain%2Fmeeting_room_booking_system_frontend_admin" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/meeting_room_booking_system_frontend_admin" ref="nofollow noopener noreferrer">小册仓库</a>。</p>
<h2 data-id="heading-0">总结</h2>
<p>这节我们实现了管理端的用户信息修改和密码修改的页面。</p>
<p>首先添加了一个和管理页面平级的二级路由，然后添加了两个组件。</p>
<p>这两个页面都是表单，涉及到回显数据、发送验证码、上传文件、更新接口。</p>
<p>这也是管理系统的常见功能。</p>
<p>下节开始，我们就开始写会议室管理的功能了。</p></div>